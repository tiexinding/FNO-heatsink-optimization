root@f775a8ad96db:/workspace/pytorch-learning# python 06-enginering-opt-gpu.py

======================================================================
神经算子工程应用：散热器设计优化 (GPU加速版)
======================================================================

关键理解：
  × 不是：初始条件 → 时间演化
  ✓ 而是：设计参数 → 性能场

这才是工业界最常用的模式！


======================================================================
✓ GPU可用: NVIDIA T600 Laptop GPU
  CUDA版本: 12.9
  显存: 4.29 GB
======================================================================


【步骤1】生成训练数据
----------------------------------------------------------------------
======================================================================
工程案例：散热器设计优化 (GPU加速版)
======================================================================

这不是时间演化！而是参数到场的映射：
  输入：设计参数（高度、间距、材料...）
  输出：稳态温度场
  应用：快速评估设计性能

生成 400 个散热器设计方案...
  完成 100/400 个设计...
  完成 200/400 个设计...
  完成 300/400 个设计...
  完成 400/400 个设计...

✓ 数据生成完成并已加载到cuda:0
  设计参数形状: torch.Size([400, 4])
  温度场形状: torch.Size([400, 64, 64])

【步骤2】生成测试数据
----------------------------------------------------------------------
======================================================================
工程案例：散热器设计优化 (GPU加速版)
======================================================================

这不是时间演化！而是参数到场的映射：
  输入：设计参数（高度、间距、材料...）
  输出：稳态温度场
  应用：快速评估设计性能

生成 100 个散热器设计方案...
  完成 100/100 个设计...

✓ 数据生成完成并已加载到cuda:0
  设计参数形状: torch.Size([100, 4])
  温度场形状: torch.Size([100, 64, 64])

【步骤3】创建模型
----------------------------------------------------------------------
模型参数量: 18,138,625
模型已加载到: cuda:0

【步骤4】GPU加速训练
----------------------------------------------------------------------

======================================================================
开始GPU加速训练：学习 设计参数 → 温度场 的映射
======================================================================

训练配置：
  设备: cuda:0
  批大小: 32
  批次数/epoch: 13
  混合精度: 启用
  总样本: 400

Epoch  20 | Loss: 655.470459 | Max Temp Error: 23.43°C | Time: 1.55s
Epoch  40 | Loss: 255.916937 | Max Temp Error: 12.43°C | Time: 1.56s
Epoch  60 | Loss: 29.803176 | Max Temp Error: 11.36°C | Time: 1.57s
Epoch  80 | Loss: 1.075989 | Max Temp Error: 1.12°C | Time: 1.58s
Epoch 100 | Loss: 0.180116 | Max Temp Error: 0.70°C | Time: 1.56s
Epoch 120 | Loss: 0.765798 | Max Temp Error: 3.53°C | Time: 1.57s
Epoch 140 | Loss: 0.198621 | Max Temp Error: 0.99°C | Time: 0.85s
Epoch 160 | Loss: 0.126035 | Max Temp Error: 0.58°C | Time: 1.56s
Epoch 180 | Loss: 0.165500 | Max Temp Error: 0.74°C | Time: 1.56s
Epoch 200 | Loss: 0.214156 | Max Temp Error: 0.46°C | Time: 1.53s
Epoch 220 | Loss: 0.232487 | Max Temp Error: 0.66°C | Time: 1.55s
Epoch 240 | Loss: 0.162643 | Max Temp Error: 1.13°C | Time: 1.55s
Epoch 260 | Loss: 0.252828 | Max Temp Error: 0.55°C | Time: 1.55s
Epoch 280 | Loss: 0.249448 | Max Temp Error: 0.64°C | Time: 1.56s
Epoch 300 | Loss: 0.156731 | Max Temp Error: 0.50°C | Time: 1.55s
Epoch 320 | Loss: 0.120249 | Max Temp Error: 0.25°C | Time: 1.55s
Epoch 340 | Loss: 0.133983 | Max Temp Error: 0.30°C | Time: 1.54s
Epoch 360 | Loss: 0.220820 | Max Temp Error: 0.59°C | Time: 1.54s
Epoch 380 | Loss: 0.279066 | Max Temp Error: 0.84°C | Time: 1.56s
Epoch 400 | Loss: 0.184015 | Max Temp Error: 0.29°C | Time: 1.56s
Epoch 420 | Loss: 0.096964 | Max Temp Error: 0.27°C | Time: 1.56s
Epoch 440 | Loss: 0.180332 | Max Temp Error: 0.39°C | Time: 1.54s
Epoch 460 | Loss: 0.065318 | Max Temp Error: 0.19°C | Time: 1.56s
Epoch 480 | Loss: 0.103051 | Max Temp Error: 0.27°C | Time: 1.55s
Epoch 500 | Loss: 0.128745 | Max Temp Error: 0.25°C | Time: 1.55s

✓ 训练完成！
  平均每epoch时间: 1.55秒

【步骤5】测试性能
----------------------------------------------------------------------
平均绝对误差: 0.086°C
最高温度误差: 0.322°C

生成预测vs真值对比图...
✓ 预测对比图已保存: prediction_vs_truth.png

【步骤6】GPU加速设计优化
----------------------------------------------------------------------

======================================================================
工程应用演示：GPU加速设计优化
======================================================================

设计空间：
  散热片高度: 10-30 mm
  散热片间距: 2-8 mm
  材料导热率: 100-400 W/m·K
  热源功率: 100 W (固定)

生成 10000 个候选设计...

使用GPU评估所有 10000 个设计...
✓ GPU评估完成
  时间：29.086秒
  速度：343.8 设计/秒

对比传统CFD方法：
  传统CFD时间：40000 小时 (1666.7 天)
  GPU神经算子：29.086 秒
  加速比：4950884×

最优设计：
  散热片高度：20.4 mm
  散热片间距：2.0 mm
  材料导热率：184 W/m·K
  最高温度：54.0°C
/workspace/pytorch-learning/06-enginering-opt-gpu.py:559: UserWarning: Glyph 11088 (\N{WHITE MEDIUM STAR}) missing from font(s) DejaVu Sans.
  plt.tight_layout()
/workspace/pytorch-learning/06-enginering-opt-gpu.py:560: UserWarning: Glyph 11088 (\N{WHITE MEDIUM STAR}) missing from font(s) DejaVu Sans.
  plt.savefig('./outputs/heatsink_optimization_gpu.png',

✓ 结果可视化已保存: heatsink_optimization_gpu.png

======================================================================
GPU加速总结
======================================================================

GPU优势：
  ✓ FFT运算：GPU比CPU快10-100倍
  ✓ 矩阵乘法：GPU并行计算
  ✓ 批处理：一次评估10000+设计
  ✓ 混合精度：FP16加速2-3倍

实际应用：
  - CPU训练：2-4小时/500 epochs
  - GPU训练：10-30分钟/500 epochs
  - 设计评估：10000个设计 < 1秒
  - 实时反馈：设计师可以交互式优化

这就是为什么GPU对神经算子如此重要！
======================================================================
root@f775a8ad96db:/workspace/pytorch-learning#